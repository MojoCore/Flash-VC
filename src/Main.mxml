<?xml version="1.0" encoding="utf-8"?>

<s:Application name="Spark_VideoPlayer_skinClass_scrubBar_test"
               xmlns:fx="http://ns.adobe.com/mxml/2009"
               xmlns:s="library://ns.adobe.com/flex/spark" creationComplete="InitApp()"
               xmlns:custom="components.*" xmlns:mx="library://ns.adobe.com/flex/mx" applicationComplete="initAppComplete()">

    <fx:Script><![CDATA[
        import mx.binding.utils.ChangeWatcher;
        import mx.controls.Alert;
        import mx.controls.Alert;
        import mx.core.Application;
        import mx.core.FlexGlobals;
        import mx.managers.BrowserManager;

        import util.ParamsUrl;

        import util.swfSelfResize;

        private var widthWatch:ChangeWatcher;
        public var app:App = new App();
        private var resize:swfSelfResize;

        private function InitApp():void {
            app.InitializeComponents(this, systemManager.stage.stageWidth);
            Security.allowDomain("*");
            flash.system.Security.allowDomain("*");
            btnTabCart.ActiveTab();
            btnTabCart.subtitleLabel.text = '';
            formResponsiveScroller.viewport.verticalScrollPosition = 50;
        }


        private function initAppComplete():void {
            var pathArray = url.split('/');
            var protocol = pathArray[0];
            var host = pathArray[2];
            var newurl = protocol + '//' + host+'/';
            //Alert.show(newurl)
            ParamsUrl.SetLocalhost(newurl);
            app.Init();
            //Alert.show(newurl);
            widthWatch = ChangeWatcher.watch(this, 'width', onSizeChange);



        }

        private function onSizeChange(event:Event):void {
            if (stage.stageWidth < 640) {
                app.ChangeResponsive();
            } else {
                app.ChangeDefault();
            }
        }
        ]]></fx:Script>
<fx:Style source="styles/app.css"/>
<mx:Box direction="vertical" width="100%" height="100%">
    <s:Group width="100%" height="100%">
    <s:VideoPlayer id="videoPlayer"
                   skinClass="skins.SkinVideo"
                   width="100%"
                   height="100%" />
    <custom:CardResponsive id="cardR"
                           bottom="26"
                           left="0"
                           width="100%"
                           height="45"
                           textAlign="center"
                           visible="false"/>
        <custom:InCaseYouMissedResponsive width="100%" height="100%" id="inCaseYouMissedResponsive" bottom="26" visible="false">

        </custom:InCaseYouMissedResponsive>
    </s:Group>
    <mx:Box id="footer" width="100%" height="200" direction="vertical"  backgroundColor="0xf5f5f7" backgroundAlpha="1">

        <s:HGroup gap="1" width="100%" paddingLeft="2" paddingRight="2">
            <custom:CustomTabCart iconFont="&#xe612;" id="btnTabCart" otherTabButton="{btnTabCheckout}" width="150" title="MY CART" subtitle="10" viewStack="{ViewStackContentResponsive}" activeTab="0"></custom:CustomTabCart>
            <custom:CustomTabCheckout iconFont="&#xe611;" id="btnTabCheckout" otherTabButton="{btnTabCart}" width="100%" title="CHECKOUT" viewStack="{ViewStackContentResponsive}" activeTab="1"></custom:CustomTabCheckout>
            <!--s:Button width="100%" height="100%" skinClass="skins.SkinTabTabHeader"></s:Button-->
        </s:HGroup>

        <mx:ViewStack id="ViewStackContentResponsive" width="100%" height="100%" creationPolicy="all" backgroundColor="0xf5f5f7">
            <s:NavigatorContent id="contentCartResponsive" label="MY CART" width="100%" height="100%">
                <custom:CartResponsive id="cartBoxResponsive" width="100%">

                </custom:CartResponsive>
            </s:NavigatorContent>
            <s:NavigatorContent id="contentFormResponsive" label="CHECKOUT" width="100%" height="100%">
                <mx:ViewStack id="CheckoutViewStackResponsive" width="100%" height="100%" creationPolicy="all">
                    <s:NavigatorContent id="formCheckoutContentResponsive"  width="100%" height="100%" >
                        <s:Scroller width="100%" height="100%" id="formResponsiveScroller" skinClass="skins.SkinScroller">

                            <s:VGroup width="100%" clipAndEnableScrolling="true">
                                <custom:CheckoutResponsiveBox width="100%" id="checkoutBoxResponsive" paddingLeft="0" paddingRight="0" />
                            </s:VGroup>
                        </s:Scroller>
                    </s:NavigatorContent>
                    <s:NavigatorContent id="FinishCheckoutContentResponsive"  width="100%" height="100%" >
                        <custom:CheckoutCompletedResponsiveBox width="100%">

                        </custom:CheckoutCompletedResponsiveBox>
                    </s:NavigatorContent>
                </mx:ViewStack>
            </s:NavigatorContent>
        </mx:ViewStack>



    </mx:Box>

</mx:Box>
    <custom:CardDefault id="card"
                 bottom="50"
                 left="20"
                 width="200"
                 height="231"
                 textAlign="center"
                 visible="false"/>


        <mx:HDividedBox width="100%" height="100%" top="0" bottom="25" left="0" horizontalGap="0" verticalScrollPolicy="off" horizontalScrollPolicy="off">
        <custom:Cart id="CartBox"
                     horizontalScrollPolicy="off"
                     direction="vertical"

                     width="0%"
                     height="100%"
                     borderStyle="solid"
                     backgroundColor="0xFFFFFF"
                     backgroundAlpha=".9"
                     paddingTop="0"
                     paddingBottom="0"
                     paddingLeft="0"
                     paddingRight="0"
                     x="0"></custom:Cart>
            <custom:InCaseYouMissedDefault id="inCaseYouMissedDefault" width="100%" height="100%" paddingTop="0" visible="false"></custom:InCaseYouMissedDefault>
    </mx:HDividedBox>


    <s:Button id="cartButton"
              label="&#xe604;"
              fontSize="30"
              color="white"
              top="20"
              right="20"

              skinClass="skins.SkinCircleButton"
              useHandCursor="true"
              buttonMode="true"  />
    <s:Button id="countButton"
              skinClass="skins.SkinCircleButtonText"
              top="10"
              right="11"
              color="white"
              visible="false" />

    <mx:ViewStack id="CheckoutViewStack" borderStyle="solid"  horizontalCenter="0" y="{-checkoutBox.height}" height="450" minHeight="450" maxWidth="900" width="100%"  backgroundColor="0x000" backgroundAlpha="0.8">
            <s:NavigatorContent id="formCheckoutContent"  width="100%" height="100%">
                <custom:CheckoutDefaultBox id="checkoutBox"   visible="true" minHeight="450" width="100%" height="100%">

                </custom:CheckoutDefaultBox>
            </s:NavigatorContent>
        <s:NavigatorContent id="FinishCheckoutContent"  width="100%" height="100%" horizontalCenter="0" includeInLayout="true">
            <custom:CheckoutCompletedBox id="CheckoutCompletedBox" width="100%" height="100%">

            </custom:CheckoutCompletedBox>
        </s:NavigatorContent>
    </mx:ViewStack>

</s:Application>
